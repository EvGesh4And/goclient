{% extends "asm2504/st23/base.html" %}

{% block title %}–ì–ª–∞–≤–Ω–∞—è - MS cafe{% endblock %}

{% block content %}

{% if dishes %}
<section class="menu-section">
    <h2 class="section-title">–ú–µ–Ω—é</h2>

    {% set indexed_dishes = [] %}
    {% for dish in dishes %}
        {% set _ = indexed_dishes.append(dish) %}
    {% endfor %}

    {% set main_dishes = indexed_dishes|selectattr('type', 'equalto', 'MainDish')|list %}
    {% set desserts = indexed_dishes|selectattr('type', 'equalto', 'Dessert')|list %}

    <div class="two-columns">
        <div class="column">
            <div class="column-header">
                <div class="column-icon">üçΩÔ∏è</div>
                <h3 class="column-title">–û—Å–Ω–æ–≤–Ω–æ–µ</h3>
                <span class="column-count">{{ main_dishes|length }}</span>
            </div>

            <div class="column-dishes">
                {% if main_dishes %}
                    {% for dish in main_dishes %}
                    <div class="dish-card-compact">
                        <div class="dish-header-compact">
                            <h4 class="dish-name-compact">{{ dish.name }}</h4>
                            <span class="dish-badge primary">–û—Å–Ω–æ–≤–Ω–æ–µ</span>
                        </div>
                        <div class="dish-details-compact">
                            <p><strong>–ö—É—Ö–Ω—è:</strong> {{ dish.cuisine }}</p>
                            <p><strong>–ö–∞–ª–æ—Ä–∏–∏:</strong> {{ dish.calories }} –∫–∫–∞–ª</p>
                            {% if dish.garnish is defined %}
                                <p><strong>–ì–∞—Ä–Ω–∏—Ä:</strong> {{ dish.garnish }}</p>
                            {% endif %}
                        </div>
                        <div class="dish-actions-compact">
                            <a href="{{ url_for('bp.edit_dish', index=dish.index) }}" class="btn btn-outline btn-sm">
                                ‚úèÔ∏è
                            </a>
                            <a href="{{ url_for('bp.delete_dish', index=dish.index) }}" class="btn btn-danger btn-sm"
                               onclick="return confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ –±–ª—é–¥–æ?')">
                                üóëÔ∏è
                            </a>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="empty-column">
                        <div class="icon">üçΩÔ∏è</div>
                        <h4>–ù–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã—Ö –±–ª—é–¥</h4>
                        <p>–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤–æ–µ –æ—Å–Ω–æ–≤–Ω–æ–µ –±–ª—é–¥–æ</p>
                        <a href="{{ url_for('bp.add_dish') }}" class="btn btn-outline btn-sm">
                            –î–æ–±–∞–≤–∏—Ç—å –±–ª—é–¥–æ
                        </a>
                    </div>
                {% endif %}
            </div>
        </div>

        <div class="column">
            <div class="column-header">
                <div class="column-icon">üç∞</div>
                <h3 class="column-title">–î–µ—Å–µ—Ä—Ç—ã</h3>
                <span class="column-count">{{ desserts|length }}</span>
            </div>

            <div class="column-dishes">
                {% if desserts %}
                    {% for dish in desserts %}
                    <div class="dish-card-compact">
                        <div class="dish-header-compact">
                            <h4 class="dish-name-compact">{{ dish.name }}</h4>
                            <span class="dish-badge success">–î–µ—Å–µ—Ä—Ç</span>
                        </div>
                        <div class="dish-details-compact">
                            <p><strong>–ö—É—Ö–Ω—è:</strong> {{ dish.cuisine }}</p>
                            <p><strong>–ö–∞–ª–æ—Ä–∏–∏:</strong> {{ dish.calories }} –∫–∫–∞–ª</p>
                            {% if dish.sweetness is defined %}
                                <p><strong>–°–ª–∞–¥–æ—Å—Ç—å:</strong> {{ dish.sweetness }}/10</p>
                            {% endif %}
                        </div>
                        <div class="dish-actions-compact">
                            <a href="{{ url_for('bp.edit_dish', index=dish.index) }}" class="btn btn-outline btn-sm">
                                ‚úèÔ∏è
                            </a>
                            <a href="{{ url_for('bp.delete_dish', index=dish.index) }}" class="btn btn-danger btn-sm"
                               onclick="return confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ –±–ª—é–¥–æ?')">
                                üóëÔ∏è
                            </a>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="empty-column">
                        <div class="icon">üç∞</div>
                        <h4>–ù–µ—Ç –¥–µ—Å–µ—Ä—Ç–æ–≤</h4>
                        <p>–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—ã–π –¥–µ—Å–µ—Ä—Ç</p>
                        <a href="{{ url_for('bp.add_dish') }}" class="btn btn-outline btn-sm">
                            –î–æ–±–∞–≤–∏—Ç—å –¥–µ—Å–µ—Ä—Ç
                        </a>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</section>
{% else %}

<section class="empty-state">
    <h3>–ú–µ–Ω—é –ø—É—Å—Ç–æ</h3>
    <p>–ù–∞—á–Ω–∏—Ç–µ —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–≤–æ–≥–æ –±–ª—é–¥–∞ –≤ –∫–∞—Ä—Ç–æ—Ç–µ–∫—É</p>
    <a href="{{ url_for('bp.add_dish') }}" class="action-btn">
        –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤–æ–µ –±–ª—é–¥–æ
    </a>
</section>
{% endif %}

<section class="actions-section">
    <div class="actions-grid">
        <a href="{{ url_for('bp.add_dish') }}" class="action-btn">
            ‚ûï –î–æ–±–∞–≤–∏—Ç—å
        </a>
        <a href="{{ url_for('bp.save_data') }}" class="action-btn secondary">
            üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
        </a>
        <a href="{{ url_for('bp.load_data') }}" class="action-btn secondary">
            üìÇ –ó–∞–≥—Ä—É–∑–∏—Ç—å
        </a>
        {% if dishes %}
        <a href="{{ url_for('bp.clear_all') }}" class="action-btn danger"
           onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –≤–µ—Å—å —Å–ø–∏—Å–æ–∫?')">
            üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ
        </a>
        {% endif %}
    </div>
</section>
{% endblock %}